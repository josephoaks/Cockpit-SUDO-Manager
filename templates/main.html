<!-- Toolbar -->
<div class="pf-v6-c-toolbar pf-v6-u-mb-md">
  <div class="pf-v6-c-toolbar__content pf-v6-u-justify-content-flex-end">
    <div class="pf-v6-c-toolbar__item">

      <!-- Add menu -->
      <div class="pf-v6-c-menu pf-v6-c-menu--align-right sudo-add-menu">
        <button
          class="pf-v6-c-button pf-m-primary pf-v6-c-menu-toggle"
          type="button"
          aria-expanded="false">
          Add
          <span class="pf-v6-c-menu-toggle__icon"></span>
        </button>

        <ul class="pf-v6-c-menu__list" hidden>
          <li class="pf-v6-c-menu__list-item">
            <button class="pf-v6-c-menu__item" data-action="add-user">
              Add Sudo User
            </button>
          </li>
          <li class="pf-v6-c-menu__list-item">
            <button class="pf-v6-c-menu__item" data-action="add-group">
              Add Sudo Group
            </button>
          </li>
          <li class="pf-v6-c-menu__list-item">
            <button class="pf-v6-c-menu__item" data-action="add-alias">
              Add Sudo Alias
            </button>
          </li>
        </ul>
      </div>

    </div>
  </div>
</div>

<!-- Status -->
<div id="status" class="pf-v6-u-mb-md"></div>

<!-- Rules table -->
<div class="pf-v6-c-card">
  <div class="pf-v6-c-card__body">
    <table class="pf-v6-c-table sudo-rules-table">
      <thead>
        <tr>
          <th>User</th>
          <th>Commands</th>
          <th>NOPASSWD</th>
          <th></th>
        </tr>
      </thead>
    </table>
  </div>
</div>

<!-- ===================================================== -->
<!-- ===================== TEMPLATES ===================== -->
<!-- ===================================================== -->

<!-- ===================== MODAL SHELL TEMPLATE ===================== -->
<template id="modal-shell-template">
  <div class="pf-v6-c-backdrop" hidden>
    <div class="pf-v6-c-modal-box pf-m-md"
         role="dialog"
         aria-modal="true">

      <header class="pf-v6-c-modal-box__header">
        <h1 class="pf-v6-c-modal-box__title"></h1>
      </header>

      <div class="pf-v6-c-modal-box__body"></div>

      <footer class="pf-v6-c-modal-box__footer">
        <button class="pf-v6-c-button pf-m-primary modal-apply">
          Save
        </button>
        <button class="pf-v6-c-button pf-m-link modal-cancel">
          Cancel
        </button>
      </footer>

    </div>
  </div>
</template>

<!-- ===================== USER FORM TEMPLATE ===================== -->
<template id="user-form-template">
  <form id="form" class="pf-v6-c-form">

    <div class="pf-v6-c-form__group">
      <label class="pf-v6-c-form__label">
        <span class="pf-v6-c-form__label-text">User</span>
        <input id="user" class="pf-v6-c-form-control">
      </label>
    </div>

    <div class="pf-v6-c-form__group">
      <label class="pf-v6-c-form__label">
        <span class="pf-v6-c-form__label-text">Run as</span>
        <input id="runas" class="pf-v6-c-form-control">
      </label>
    </div>

    <div class="pf-v6-c-form__group">
      <label class="pf-v6-c-check">
        <input id="allow_all" type="checkbox" class="pf-v6-c-check__input">
        <span class="pf-v6-c-check__label">Allow ALL</span>
      </label>
    </div>

    <div class="pf-v6-c-form__group">
      <label class="pf-v6-c-form__label">
        <span class="pf-v6-c-form__label-text">Commands</span>
      </label>
      <select id="commands" multiple size="8" class="pf-v6-c-form-control"></select>
    </div>

    <div class="pf-v6-c-form__group">
      <label class="pf-v6-c-check">
        <input id="nopasswd" type="checkbox" class="pf-v6-c-check__input">
        <span class="pf-v6-c-check__label">
          No password required (NOPASSWD)
        </span>
      </label>
    </div>

    <!-- Advanced sudo options -->
    <div class="pf-v6-c-form__group pf-v6-u-mt-md">

      <div class="pf-v6-c-form__label pf-v6-u-color-200 pf-v6-u-mb-sm">
        <span class="pf-v6-c-form__label-text">
          Advanced options
        </span>
      </div>

      <label class="pf-v6-c-check">
        <input id="noexec" type="checkbox" class="pf-v6-c-check__input">
        <span class="pf-v6-c-check__label">
          Prevent shell escape (NOEXEC)
        </span>
      </label>

      <label class="pf-v6-c-check pf-v6-u-mt-sm">
        <input id="setenv" type="checkbox" class="pf-v6-c-check__input">
        <span class="pf-v6-c-check__label">
          Allow environment variables (SETENV)
        </span>
      </label>

      <label class="pf-v6-c-check pf-v6-u-mt-sm">
        <input id="log_input" type="checkbox" class="pf-v6-c-check__input">
        <span class="pf-v6-c-check__label">
          Log input
        </span>
      </label>

      <label class="pf-v6-c-check pf-v6-u-mt-sm">
        <input id="log_output" type="checkbox" class="pf-v6-c-check__input">
        <span class="pf-v6-c-check__label">
          Log output
        </span>
      </label>

    </div>

  </form>
</template>

<!-- ===================== ALIAS FORM TEMPLATE ===================== -->
<template id="alias-form-template">
  <form id="alias-form" class="pf-v6-c-form">

    <div class="pf-v6-c-form__group">
      <label class="pf-v6-c-form__label">
        <span class="pf-v6-c-form__label-text">Alias type</span>
      </label>
      <select id="alias-type" class="pf-v6-c-form-control">
        <option value="">Select alias type</option>
        <option value="User_Alias">User Alias</option>
        <option value="Runas_Alias">RunAs Alias</option>
        <option value="Host_Alias">Host Alias</option>
        <option value="Cmnd_Alias">Command Alias</option>
      </select>
    </div>

    <div class="pf-v6-c-form__group">
      <label class="pf-v6-c-form__label">
        <span class="pf-v6-c-form__label-text">Alias name</span>
      </label>
      <input id="alias-name" class="pf-v6-c-form-control">
    </div>

    <div class="pf-v6-c-form__group">
      <label class="pf-v6-c-form__label">
        <span class="pf-v6-c-form__label-text">Members</span>
      </label>
      <textarea id="alias-members" rows="6" class="pf-v6-c-form-control"></textarea>
    </div>

  </form>
</template>

<!-- ===================== GROUP FORM TEMPLATE ===================== -->
<template id="group-form-template">
  <form id="group-form" class="pf-v6-c-form">

    <div class="pf-v6-c-form__group">
      <label class="pf-v6-c-form__label">
        <span class="pf-v6-c-form__label-text">Group</span>
        <input id="group" class="pf-v6-c-form-control">
      </label>
    </div>

    <div class="pf-v6-c-form__group">
      <label class="pf-v6-c-form__label">
        <span class="pf-v6-c-form__label-text">Run as</span>
        <input id="group-runas" class="pf-v6-c-form-control">
      </label>
    </div>

    <div class="pf-v6-c-form__group">
      <label class="pf-v6-c-check">
        <input id="group-allow-all" type="checkbox" class="pf-v6-c-check__input">
        <span class="pf-v6-c-check__label">Allow ALL</span>
      </label>
    </div>

    <div class="pf-v6-c-form__group">
      <label class="pf-v6-c-form__label">
        <span class="pf-v6-c-form__label-text">Commands</span>
      </label>
      <select id="group-commands" multiple size="8" class="pf-v6-c-form-control"></select>
    </div>

  </form>
</template>
